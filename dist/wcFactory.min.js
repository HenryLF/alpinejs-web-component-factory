import t from"alpinejs";export function wcFactory(r,a){let e;typeof a=="string"?(e=document.createElement("template"),e.innerHTML=a):e=a;class o extends HTMLElement{root;value;state;masterUpdate=!1;static observedAttributes=["val"];constructor(){super(),this.root=this.attachShadow({mode:"open"});const i=this.getAttribute("x-model");i&&this.setAttribute(":val",`JSON.stringify(${i})`);const n=()=>{this.dispatchEvent(new Event("input"))};this.state=t.reactive({data:t.reactive({})});let s=!0;t.effect(()=>{if(JSON.stringify(this.state.data),s||this.masterUpdate){s=!1;return}this.value=t.raw(this.state.data),n()})}attributeChangedCallback(i,n,s){this.masterUpdate=!0,Object.assign(this.state.data,JSON.parse(s)),this.masterUpdate=!1}connectedCallback(){this.root.appendChild(e.content.cloneNode(!0)),t.addScopeToNode(this.root,this.state),t.initTree(this.root)}}customElements.define(r,o)}
